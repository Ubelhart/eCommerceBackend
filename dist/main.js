(()=>{"use strict";var t={505:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(o(752)),s=process.env.PORT||8080;i.default.listen(s,(()=>{console.log(`Servidor corriendo en http://localhost:${s}`)}))},752:function(t,e,o){var r=this&&this.__createBinding||(Object.create?function(t,e,o,r){void 0===r&&(r=o);var i=Object.getOwnPropertyDescriptor(e,o);i&&!("get"in i?!e.__esModule:i.writable||i.configurable)||(i={enumerable:!0,get:function(){return e[o]}}),Object.defineProperty(t,r,i)}:function(t,e,o,r){void 0===r&&(r=o),t[r]=e[o]}),i=this&&this.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&r(e,t,o);return i(e,t),e},n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),o(81);const d=n(o(860)),c=n(o(114)),a=n(o(422)),u=o(913),l=n(o(351)),h=(0,d.default)();switch(process.env.DB){case"mariaSql":Promise.resolve().then((()=>s(o(971)))).then((({Sqlite3DaoCarts:t,MariaDbDaoProducts:e})=>{h.use("/api/carrito",new c.default(new t(u.sqlite3)).router),h.use("/api/productos",new a.default(new e(u.mariadb)).router)}));break;case"mongoDb":Promise.resolve().then((()=>s(o(971)))).then((({MongoDbDaoCarts:t,MongoDbDaoProducts:e})=>{h.use("/api/carrito",new c.default(new t(u.mongoDbKey)).router),h.use("/api/productos",new a.default(new e(u.mongoDbKey)).router)}));break;case"firebase":Promise.resolve().then((()=>s(o(971)))).then((({FirebaseDaoCarts:t,FirebaseDaoProducts:e})=>{h.use("/api/carrito",new c.default(new t(l.default)).router),h.use("/api/productos",new a.default(new e(l.default)).router)}));break;default:Promise.resolve().then((()=>s(o(971)))).then((({FileDaoCarts:t,FileDaoProducts:e})=>{h.use("/api/carrito",new c.default(new t("carts.txt")).router),h.use("/api/productos",new a.default(new e("products.txt")).router)}))}e.default=h},802:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,o){"true"===t.headers.admin?o():e.status(401).json({error:"No autorizado"})}},913:(t,e)=>{Object.defineProperty(e,"__esModule",{value:!0}),e.sqlite3=e.mariadb=e.mongoDbKey=void 0,e.mongoDbKey="mongodb+srv://juanpablo:020694@cluster0.qspzf.mongodb.net/ecommerce?retryWrites=true&w=majority",e.mariadb={client:"mysql",connection:{host:"127.0.0.1",user:"root",password:"",database:"ecommerce"}},e.sqlite3={client:"sqlite3",connection:{filename:"./src/db/mydb.sqlite"},useNullAsDefault:!0}},89:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0});const i=o(147);e.default=class{constructor(t){this.config=t,this.fs=i.promises,this.products=[]}createIfNotExist(){return r(this,void 0,void 0,(function*(){let t;try{t=yield i.promises.readFile(this.config)}catch(t){if("ENOENT"===t.code)return yield i.promises.writeFile(this.config,"[]").then((()=>{console.log(`No existe ${this.config}. Archivo creado.`)})),yield i.promises.readFile(this.config);console.log("Hubo un error",t)}return t}))}}},627:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(o(509));e.default=class{constructor(t){this.config=t,this.admin=i.default}connect(){i.default.initializeApp({credential:i.default.credential.cert(this.config)}),console.log("Firebase connected")}}},231:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(o(514));e.default=class{constructor(t){this.knex=(0,i.default)(t)}}},135:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(o(185));e.default=class{constructor(t){this.config=t}connect(){return r(this,void 0,void 0,(function*(){try{yield s.default.connect(this.config),console.log("MongoDB connected")}catch(t){console.log("MongoDB connection error",t)}}))}}},808:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(o(89));class s extends i.default{constructor(t){super(t),this.postCart=this.postCart.bind(this),this.deleteCart=this.deleteCart.bind(this),this.getCart=this.getCart.bind(this),this.postProduct=this.postProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this)}postCart(t,e){const o={timestamp:(new Date).toString(),products:t.body};this.createIfNotExist().then((t=>{if(this.products=JSON.parse(t.toString()),!this.products.length)return o.id=1;o.id=this.products.at(-1).id+1})).finally((()=>{this.products.push(o),this.fs.writeFile("./carts.txt",JSON.stringify(this.products)),e.json(`El carrito con el id:${o.id} ha sido agregado`)}))}deleteCart(t,e){const o=parseInt(t.params.id);let r;this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString()),r=this.products.find((t=>t.id===o))})).finally((()=>{if(r)return this.products=this.products.filter((t=>t.id!==o)),this.fs.writeFile("./carts.txt",JSON.stringify(this.products)),e.json(`El carrito con el id:${t.params.id} ha sido eliminado`);e.json({error:"carrito no encontrado"})}))}getCart(t,e){const o=parseInt(t.params.id);this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString())})).finally((()=>{const t=this.products.find((t=>t.id===o));if(t)return e.json(t);e.json({error:"carrito no encontrado"})}))}postProduct(t,e){const o=parseInt(t.params.id);let r;this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString()),r=this.products.find((t=>t.id===o))})).finally((()=>{if(r)return r.products.push(t.body),this.fs.writeFile("./carts.txt",JSON.stringify(this.products)),e.json(r);e.json({error:"carrito no encontrado"})}))}deleteProduct(t,e){const o=parseInt(t.params.id),r=parseInt(t.params.id_prod);let i;this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString()),i=this.products.find((t=>t.id===o&&t.products))})).finally((()=>{if(i)return i.products.find((t=>t.id===r))?(i.products=i.products.filter((t=>t.id!==r)),this.fs.writeFile("./carts.txt",JSON.stringify(this.products)),e.json(`El producto con el id:${r} ha sido eliminado`)):e.json({error:"producto no encontrado"});e.json({error:"carrito no encontrado"})}))}}e.default=s},792:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(o(627));class n extends s.default{constructor(t){super(t),this.connect(),this.db=this.admin.firestore(),this.query=this.db.collection("carts"),this.postCart=this.postCart.bind(this),this.deleteCart=this.deleteCart.bind(this),this.getCart=this.getCart.bind(this),this.postProduct=this.postProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this)}postCart(t,e){return r(this,void 0,void 0,(function*(){try{const o={timestamp:(new Date).toString(),products:[]};t.body&&!t.body.length?o.products.push(t.body):t.body.length&&(o.products=t.body);const r=this.query.doc(),i=r._path.segments[1];yield r.create(o),e.json(`El carrito con el id:${i} ha sido insertado`)}catch(t){console.log(t),e.json({error:"no se pudo insertar carrito"})}}))}deleteCart(t,e){return r(this,void 0,void 0,(function*(){try{const o=this.query.doc(t.params.id),r=yield o.get(),i=Object.assign({id:o.id},r.data());try{if(i.products)return yield o.delete(),e.json(`El carrito con el id:${t.params.id} ha sido eliminado`);e.json({error:"carrito no encontrado"})}catch(t){console.log("Error al eliminar el carrito",t)}}catch(t){console.log("Error al obtener los datos del carrito",t)}}))}getCart(t,e){return r(this,void 0,void 0,(function*(){try{const o=yield this.query.doc(t.params.id),r=yield o.get(),i=Object.assign({id:o.id},r.data());if(!i.products)return e.json({error:"carrito no encontrado"});if(i.products.length)return e.json(i);e.json("El carrito esta vació")}catch(t){console.log("Error al obtener los datos del carrito",t)}}))}postProduct(t,e){return r(this,void 0,void 0,(function*(){try{const o=this.admin.firestore.FieldValue.arrayUnion,r=this.query.doc(t.params.id),i=yield r.get(),s=Object.assign({id:r.id},i.data());try{if(s.products)return yield r.update({products:o(t.body)}),e.json("Producto insertado con éxito");e.json({error:"carrito no encontrado"})}catch(t){console.log("Error insertar el producto",t)}}catch(t){console.log("Error al obtener los datos del carrito",t)}}))}deleteProduct(t,e){return r(this,void 0,void 0,(function*(){try{const o=this.query.doc(t.params.id),r=yield o.get(),i=Object.assign({id:o.id},r.data());let s;i.products&&(s=i.products.find((e=>e.id===t.params.id_prod)));try{if(s){const r=this.admin.firestore.FieldValue.arrayRemove;return yield o.update({products:r(s)}),e.json(`El producto con el id:${t.params.id_prod} ha sido eliminado del carrito con el id:${t.params.id}`)}if(i.products)return e.json(`El producto con el id:${t.params.id_prod} no existe en el carrito con el id:${t.params.id}`);e.json({error:"carrito no encontrado"})}catch(t){console.log("Error al eliminar el producto",t)}}catch(t){console.log("Error al obtener los datos del carrito",t)}}))}}e.default=n},303:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(o(135)),n=o(794);class d extends s.default{constructor(t){super(t),this.postCart=this.postCart.bind(this),this.deleteCart=this.deleteCart.bind(this),this.getCart=this.getCart.bind(this),this.postProduct=this.postProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this)}postCart(t,e){return r(this,void 0,void 0,(function*(){const o=new n.Cart;yield o.save(((o,r)=>{if(o)console.log("Error al crear el carrito",o);else if(0===Object.keys(t.body).length)return e.json({error:"no puedes crear un carrito vació"});r.products=t.body,r.save(),e.json(`El carrito con el id:${r._id} ha sido creado`)}))}))}deleteCart(t,e){n.Cart.findByIdAndRemove(t.params.id,((o,r)=>{if(r)return e.json(`El carrito con el id:${t.params.id} ha sido eliminado`);o&&console.log("Error al eliminar el carrito",o),e.json({error:"carrito no encontrado"})}))}getCart(t,e){n.Cart.findById(t.params.id,((t,o)=>{if(t)return console.log(t),e.json({error:"carrito no encontrado"});e.json(o.products)}))}postProduct(t,e){n.Cart.findById(t.params.id,((o,r)=>{if(o)return console.log(o),e.json({error:"carrito no encontrado"});r.products.push(t.body),r.save(),e.json(r.products)}))}deleteProduct(t,e){n.Cart.findByIdAndUpdate(t.params.id,{$pull:{products:{_id:t.params.id_prod}}},((o,r)=>o?(console.log(o),e.json({error:"carrito no encontrado"})):r.products.find((e=>e._id==t.params.id_prod))?e.json(`El producto con el id:${t.params.id_prod} ha sido eliminado del carrito con el id:${t.params.id}`):void e.json(`El producto con el id:${t.params.id_prod} no existe en el carrito con el id:${t.params.id}`)))}}e.default=d},526:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(o(231));class n extends s.default{constructor(t){super(t),this.postCart=this.postCart.bind(this),this.deleteCart=this.deleteCart.bind(this),this.getCart=this.getCart.bind(this),this.postProduct=this.postProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this)}createIfNotExists(){return r(this,void 0,void 0,(function*(){try{yield this.knex.schema.createTable("carts",(t=>{t.increments("id"),t.string("title"),t.timestamp("timestamp")}))}catch(t){console.log(t.sqlMessage)}}))}createIfNotExistsProducts(){return r(this,void 0,void 0,(function*(){try{yield this.knex.schema.createTable("carts_products",(t=>{t.integer("id"),t.integer("cart_id"),t.string("title"),t.string("description"),t.string("thumbnail"),t.float("price"),t.integer("stock"),t.string("timestamp")}))}catch(t){console.log(t.sqlMessage)}}))}postCart(t,e){return r(this,void 0,void 0,(function*(){yield this.createIfNotExists(),yield this.createIfNotExistsProducts();try{const o=yield this.knex("carts").insert({title:"Carrito"});try{t.body.forEach((t=>{t.cart_id=o[0]})),yield this.knex("carts_products").insert(t.body),e.json(`Se agrego el carrito con id ${o}`)}catch(t){console.log(t)}}catch(t){console.log(t)}}))}deleteCart(t,e){return r(this,void 0,void 0,(function*(){try{yield this.knex("carts_products").where("cart_id",t.params.id).del()}catch(t){console.log(t)}try{yield this.knex("carts").where("id",t.params.id).del(),e.json("carrito eliminado")}catch(t){console.log(t)}}))}getCart(t,e){return r(this,void 0,void 0,(function*(){try{const o=yield this.knex.from("carts_products").select("*").where("cart_id",t.params.id);e.json(o)}catch(t){console.log(t)}}))}postProduct(t,e){return r(this,void 0,void 0,(function*(){let o;try{o=yield this.knex.from("carts").select("*").where("id",t.params.id)}catch(t){console.log(t)}try{if(o.length){const o=Object.assign({cart_id:{type:Number}},t.body);return o.cart_id=t.params.id,yield this.knex("carts_products").insert(o),e.json("Producto insertado correctamente")}e.json({error:"carrito no existe"})}catch(t){console.log(t)}}))}deleteProduct(t,e){return r(this,void 0,void 0,(function*(){try{yield this.knex("carts_products").where("id",t.params.id_prod).andWhere("cart_id",t.params.id).del(),e.json("producto eliminado")}catch(t){console.log(t)}}))}}e.default=n},971:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.MariaDbDaoProducts=e.Sqlite3DaoCarts=e.FirebaseDaoProducts=e.FirebaseDaoCarts=e.MongoDbDaoProducts=e.MongoDbDaoCarts=e.FileDaoProducts=e.FileDaoCarts=void 0;const i=r(o(808));e.FileDaoCarts=i.default;const s=r(o(722));e.FileDaoProducts=s.default;const n=r(o(303));e.MongoDbDaoCarts=n.default;const d=r(o(179));e.MongoDbDaoProducts=d.default;const c=r(o(792));e.FirebaseDaoCarts=c.default;const a=r(o(593));e.FirebaseDaoProducts=a.default;const u=r(o(526));e.Sqlite3DaoCarts=u.default;const l=r(o(470));e.MariaDbDaoProducts=l.default},722:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=r(o(89));class s extends i.default{constructor(t){super(t),this.getProduct=this.getProduct.bind(this),this.postProduct=this.postProduct.bind(this),this.putProduct=this.putProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this),this.getProducts=this.getProducts.bind(this)}getProducts(t,e){this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString())})).finally((()=>{e.json(this.products)}))}postProduct(t,e){const o=t.body;this.createIfNotExist().then((t=>{if(this.products=JSON.parse(t.toString()),!this.products.length)return o.id=1;o.id=this.products.at(-1).id+1})).finally((()=>{o.timestamp=(new Date).toString(),this.products.push(o),this.fs.writeFile(this.config,JSON.stringify(this.products)),e.json(this.products)}))}getProduct(t,e){const o=parseInt(t.params.id);let r;t.query.admin,this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString()),r=this.products.find((t=>t.id===o))})).finally((()=>{if(r)return e.json(r);e.json({error:"producto no encontrado"})}))}putProduct(t,e){const o=parseInt(t.params.id);let r;this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString()),r=this.products.find((t=>t.id===o))})).finally((()=>{if(r)return this.products=this.products.filter((t=>t.id!==o)),t.body.id=o,this.products.push(t.body),this.fs.writeFile(this.config,JSON.stringify(this.products)),e.json(`El producto con el id:${t.params.id} ha sido actualizado`);e.json({error:"producto no encontrado"})}))}deleteProduct(t,e){const o=parseInt(t.params.id);let r;this.createIfNotExist().then((t=>{this.products=JSON.parse(t.toString()),r=this.products.find((t=>t.id===o))})).finally((()=>{if(r)return this.products=this.products.filter((t=>t.id!==o)),this.fs.writeFile(this.config,JSON.stringify(this.products)),e.json(`El producto con el id:${t.params.id} ha sido eliminado`);e.json({error:"producto no encontrado"})}))}}e.default=s},593:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(o(627));class n extends s.default{constructor(t){super(t),this.db=this.admin.firestore(),this.query=this.db.collection("products"),this.getProduct=this.getProduct.bind(this),this.postProduct=this.postProduct.bind(this),this.putProduct=this.putProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this),this.getProducts=this.getProducts.bind(this)}getProducts(t,e){return r(this,void 0,void 0,(function*(){try{const t=(yield this.query.get()).docs.map((t=>Object.assign({id:t.id},t.data())));if(t.length)return e.json(t);e.json({error:"no se encontraron productos"})}catch(t){console.log("Error al obtener productos",t)}}))}postProduct(t,e){return r(this,void 0,void 0,(function*(){try{t.body.timestamp=(new Date).toString();const o=this.query.doc(),r=o._path.segments[1];yield o.create(t.body),e.json(`El producto con el id:${r} ha sido insertado`)}catch(t){console.log(t),e.json({error:"no se pudo insertar producto"})}}))}getProduct(t,e){return r(this,void 0,void 0,(function*(){try{const o=this.query.doc(t.params.id),r=yield o.get(),i=Object.assign({id:o.id},r.data());if(i.title)return e.json(i);e.json({error:"producto no encontrado"})}catch(t){console.log("Error al obtener producto",t)}}))}putProduct(t,e){return r(this,void 0,void 0,(function*(){try{const o=this.query.doc(t.params.id);return yield o.update(t.body),e.json(`El producto con el id:${t.params.id} ha sido actualizado`)}catch(t){console.log(t),e.json({error:"producto no encontrado"})}}))}deleteProduct(t,e){return r(this,void 0,void 0,(function*(){try{const o=this.query.doc(t.params.id),r=yield o.get(),i=Object.assign({id:o.id},r.data());try{if(i.title)return yield o.delete(),e.json(`El producto con el id:${t.params.id} ha sido eliminado`);e.json({error:"producto no encontrado"})}catch(t){console.log("Error al eliminar producto",t)}}catch(t){console.log("Error al obtener producto",t)}}))}}e.default=n},470:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(o(231));class n extends s.default{constructor(t){super(t),this.getProduct=this.getProduct.bind(this),this.postProduct=this.postProduct.bind(this),this.putProduct=this.putProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this),this.getProducts=this.getProducts.bind(this)}createIfNotExists(){return r(this,void 0,void 0,(function*(){try{yield this.knex.schema.createTable("products",(t=>{t.increments("id"),t.string("title"),t.string("description"),t.string("thumbnail"),t.float("price"),t.integer("stock"),t.timestamp("timestamp")}))}catch(t){console.log(t.sqlMessage)}}))}getProducts(t,e){return r(this,void 0,void 0,(function*(){try{const t=yield this.knex.from("products").select("*");e.json(t)}catch(t){e.json({error:"productos no encontrados"}),console.log(t)}}))}postProduct(t,e){return r(this,void 0,void 0,(function*(){yield this.createIfNotExists();try{const o=yield this.knex("products").insert(t.body);e.json(`El producto con el id:${o} ha sido insertado`)}catch(t){console.log(t),e.json({error:"producto no insertado"})}}))}getProduct(t,e){return r(this,void 0,void 0,(function*(){try{const o=yield this.knex.from("products").select("*").where("id",t.params.id);e.json(o)}catch(t){console.log(t)}}))}putProduct(t,e){return r(this,void 0,void 0,(function*(){try{yield this.knex("products").where("id",t.params.id).update(t.body),e.json(`El producto con el id:${t.params.id} ha sido actualizado`)}catch(t){console.log(t)}}))}deleteProduct(t,e){return r(this,void 0,void 0,(function*(){try{yield this.knex("products").where("id",t.params.id).del(),e.json(`El producto con el id:${t.params.id} ha sido eliminado`)}catch(t){console.log(t)}}))}}e.default=n},179:function(t,e,o){var r=this&&this.__awaiter||function(t,e,o,r){return new(o||(o=Promise))((function(i,s){function n(t){try{c(r.next(t))}catch(t){s(t)}}function d(t){try{c(r.throw(t))}catch(t){s(t)}}function c(t){var e;t.done?i(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(n,d)}c((r=r.apply(t,e||[])).next())}))},i=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const s=i(o(135)),n=o(489);class d extends s.default{constructor(t){super(t),this.getProduct=this.getProduct.bind(this),this.postProduct=this.postProduct.bind(this),this.putProduct=this.putProduct.bind(this),this.deleteProduct=this.deleteProduct.bind(this),this.getProducts=this.getProducts.bind(this)}getProducts(t,e){n.Product.find({},((t,o)=>{t&&(console.log(t),e.send({error:"productos no encontrados"})),e.json(o)}))}postProduct(t,e){return r(this,void 0,void 0,(function*(){const o=new n.Product(t.body);yield o.save(),e.json(o)}))}getProduct(t,e){n.Product.findById(t.params.id,((t,o)=>{if(t)return e.json({error:"producto no encontrado"});e.json(o)}))}putProduct(t,e){n.Product.findByIdAndUpdate(t.params.id,t.body,(o=>{if(o)return e.json({error:"producto no encontrado"});e.json(`El producto con el id:${t.params.id} ha sido actualizado`)}))}deleteProduct(t,e){n.Product.findByIdAndRemove(t.params.id,((o,r)=>{if(r)return e.json(`El producto con el id:${t.params.id} ha sido eliminado`);e.json({error:"producto no encontrado"})}))}}e.default=d},794:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Cart=void 0;const i=r(o(185)),s=o(489),n=new i.default.Schema({products:[s.productSchema],timestamp:{type:Date,default:Date.now}});e.Cart=i.default.model("carts",n)},489:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0}),e.Product=e.productSchema=void 0;const i=r(o(185));e.productSchema=new i.default.Schema({title:{type:String,required:!0},description:{type:String,required:!0},thumbnail:{type:String,required:!0},price:{type:Number,required:!0},timestamp:{type:Date,default:Date.now},stock:{type:Number,required:!0}}),e.Product=i.default.model("products",e.productSchema)},114:(t,e,o)=>{Object.defineProperty(e,"__esModule",{value:!0});const r=o(860),i=(0,r.Router)();e.default=class{constructor(t){this.router=i,this.daoCarts=t,i.use((0,r.json)()),i.use((0,r.urlencoded)({extended:!0})),this.postCart(),this.deleteCart(),this.getCart(),this.postProduct(),this.deleteProduct()}postCart(){i.post("/",this.daoCarts.postCart)}deleteCart(){i.delete("/:id",this.daoCarts.deleteCart)}getCart(){i.get("/:id/productos",this.daoCarts.getCart)}postProduct(){i.post("/:id/productos",this.daoCarts.postProduct)}deleteProduct(){i.delete("/:id/productos/:id_prod",this.daoCarts.deleteProduct)}}},422:function(t,e,o){var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const i=o(860),s=r(o(802)),n=(0,i.Router)();e.default=class{constructor(t){this.router=n,this.daoProducts=t,n.use((0,i.json)()),n.use((0,i.urlencoded)({extended:!0})),this.getProducts(),this.postProduct(),this.getProduct(),this.putProduct(),this.deleteProduct()}getProducts(){n.get("/",this.daoProducts.getProducts)}postProduct(){n.post("/",s.default,this.daoProducts.postProduct)}getProduct(){n.get("/:id",this.daoProducts.getProduct)}putProduct(){n.put("/:id",s.default,this.daoProducts.putProduct)}deleteProduct(){n.delete("/:id",s.default,this.daoProducts.deleteProduct)}}},81:t=>{t.exports=require("dotenv/config")},860:t=>{t.exports=require("express")},509:t=>{t.exports=require("firebase-admin")},514:t=>{t.exports=require("knex")},185:t=>{t.exports=require("mongoose")},147:t=>{t.exports=require("fs")},351:t=>{t.exports=JSON.parse('{"type":"service_account","project_id":"backendecommerce-dec6c","private_key_id":"aef48c2fd1f66e64f17a9a8143a5714f941a35fa","private_key":"-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQCytu4K9Otec6Vj\\nMzrEnSCUP1Sbqa90up+uHbSp9Z/9Vd/e8YYVdiJqVzpy+R98UPz5rssfWigOHaHi\\n6kzm8a4OOlFXQdJ+57TBf1A8ZnSL9wZ3RVDYGk44hqa6xjlfD62tUC4mrrMWb/dA\\nEOZUM3RACE1xZ+g26xfvwMo5aJbRdtawJ1m0KfeR2bBiIZVqmm4aa8uJOCkdoLfU\\nBRNBhxPa/qgLKcYeJHF2OC3gCiW1875YFPiolNCBl9EzWZf/Nfb49aw5/VybKXg9\\nA61kwxKzwY0ctOBDxDnRFPppKQ7ZC+vH8s9COLNH+ns/UUgOubH08VsVDp9//6kh\\nAZHnjIRLAgMBAAECggEAAoL9hXfEQ98H8mtd5nnEMEAgaElBKTiv1dQ4P+1iNfqa\\nMLusyFj3n6gMUS4liyLNlgw36UQXYEpYMOjDrx+ABWdvnknKzSdkgVoU+lVnW8nS\\n2sYBSSHVg1TLzK7dk9GC/cOCL1bbnXwLwlcC/0riXk6uf2sgkFx+jVxTe0KJT0uA\\nYMR6j5P3gUvXLqjkTtxGlhfXYOK3GqF0Kf2JyzsZGL/0xLN7CY8gDZ7ejkh3I6Qz\\n3DUIDk5RrzWWkusF4xsup7JWH55nxdnpU/FIl4ZLC9OEN3vQFiGYL2yLo0WN02mQ\\n0OMbj1Pi6UF2oYY3rY831xtWUb/9YQR0iPDdc5dtQQKBgQDn3TG0zQXbiO9FbHkq\\nBU8Rgh5GjWMQVXG/CHYtHPPW3gc7Js9j0Q6D8/NNHhlnP6buDXgg2UEXVQhyBZpo\\nwCT6/25kPKVmi05Tufvaq8yVTXjLyp1wMWsENgDnShAKwhSeNjlLEkymwu8UnAwH\\n0orfKV32Le648ylVyNyAtHsdXQKBgQDFUWMnQkT5z/QRePj5nvGAGwmXA7MndCDH\\nqW+bhAMjT9VHuZetY5vthiBKDc/Ps6EmJzvAM9YsAErDPn+EQnmXtah/oHntd5iq\\nXuB3e3WNj5ikLJSEupJNfB3lhCiSbBK8p+go8HvOdnzU1agV0/wb5Tn7uaReCxFD\\nBWlntx9lxwKBgQCRyWOykeLn+X6wwRaiFDp2AMF2jPnH0GG3wuNDVFwBMxOK3skx\\nssYUs7O8PnusjrowHen1hYTG3eF0iA9hY8ccxrSrc/JvupGiVWOFR9ZX3iFgyeIa\\nJAhs2mPRCaFykjuSiveVO0lU5WacJ83ssTY+QO1il9jtE39e/++dQV3TxQKBgDqu\\nI5CvUpgAUhNIKLMDo8p3P/jbLtJS5NS7/OcA8XX07fawqPz1nI+czcl4Jg8c2pXg\\nIRLd15mqVJGP6phItKR7b6rU7K3EXXB9Wr/txV3eEITyhRCb85p7iOCS1wYEgeX9\\nATv7mLYj4qfhCmXDbzxUhVPpN4qIPA/0cg5YFUxNAoGADyLgrXEozVBIUUqsXwKc\\nzZwEDipHy+27GdY3fNqig//YdK/C8aw9hdNyiuQP4YGp9D1gtLdOK2WfxSvdx40n\\nwyJpEp+eiQIg/2Z/TYYfmqHsFR1YjiyO6MKsM/bBLSV4r64gZmkmc9QUFapklNBp\\nobFq9PEEZcIGB4JViUB2Tcs=\\n-----END PRIVATE KEY-----\\n","client_email":"firebase-adminsdk-hm6xm@backendecommerce-dec6c.iam.gserviceaccount.com","client_id":"111270348000462068536","auth_uri":"https://accounts.google.com/o/oauth2/auth","token_uri":"https://oauth2.googleapis.com/token","auth_provider_x509_cert_url":"https://www.googleapis.com/oauth2/v1/certs","client_x509_cert_url":"https://www.googleapis.com/robot/v1/metadata/x509/firebase-adminsdk-hm6xm%40backendecommerce-dec6c.iam.gserviceaccount.com"}')}},e={};!function o(r){var i=e[r];if(void 0!==i)return i.exports;var s=e[r]={exports:{}};return t[r].call(s.exports,s,s.exports,o),s.exports}(505)})();